USE Northwind ;
go

SELECT * FROM Customers

WHERE CustomerID IN (

select CustomerID from Customers

where CustomerID in ('ALFKI', 'ANATR', 'ANTON', 'AROUT', 'BERGS')
)

SELECT * FROM Products
WHERE CategoryID IN ( 
 SELECT TOP 5 CategoryID FROM Categories
 )

 ORDER BY CategoryID DESC 

--CONTAR 

SELECT CategoryID, COUNT(*) FROM Products p
WHERE CategoryID IN(
     SELECT TOP 5 CategoryID FROM Categories
	 )
GROUP BY CategoryID

--1
SELECT 'PIAD-302' FROM Categories
UNION 
SELECT 'PIAD-303' FROM Categories

---2
SELECT 'PIAD-302', 'PIAD-305' FROM Categories
UNION ALL
SELECT 'PIAD-303',  'PIAD-304' FROM Categories


---UNIR TODAS LAS FILAS, ID Y NOMBRE DE LAS TABLAS PRODUCTOS Y CATEGORIAS 

SELECT CategoryID,CategoryName from Categories
UNION ALL
SELECT ProductID,ProductName from Products


--consulta - uso de inner join 
SELECT * FROM Products P
INNER JOIN Categories c ON P.CategoryID = C.CategoryID

--MOSTRAR EL PROUCTOID, PRODUCTONAME,UNITPRICE,CATEGORYNAME



SELECT 
    p.ProductID,
    p.ProductName,
    p.UnitPrice,
    c.CategoryName
FROM Products p
INNER JOIN Categories c 
    ON p.CategoryID = c.CategoryID;

	--ORDERS Y CUSTOMERS --> INNER (3 COLUMNAS DE CADA TABLA)

	SELECT 
    o.OrderID,
    o.OrderDate,
    o.Freight,
    c.CustomerID,
    c.CompanyName,
    c.ContactName
FROM Orders o
INNER JOIN Customers c 
    ON o.CustomerID = c.CustomerID;


	--ORDERS Y ORDERS DETAILS --> INNER ( 5 COLUMNAS DE CADA TABLA)
	SELECT 
    o.OrderID,
    o.CustomerID,
    o.EmployeeID,
    o.OrderDate,
    o.RequiredDate,
    od.ProductID,
    od.UnitPrice,
    od.Quantity,
    od.Discount,
    od.OrderID AS OrderDetailOrderID
FROM Orders o
INNER JOIN [Order Details] od
    ON o.OrderID = od.OrderID;

--1 -- MOSTRAR EL TOTAL DE LOS "ORDERS" Y AGRUPARLOS POR COMPANY NAME
--NOTA: PARA CALCULAR EL TOTAL, LOS OBTIENES DE LA TABLA ORDER DETAILS(UNITPRICE * QUANTITY)
----ejemplo:
--ALFREDS FUTTERKISTE    -600 
--ANA TRUJILLO EMPAREDADOS Y HELADOS -956


SELECT 
    c.CompanyName,
    SUM(od.UnitPrice * od.Quantity) AS TotalOrders
FROM Customers c
INNER JOIN Orders o
    ON c.CustomerID = o.CustomerID
INNER JOIN [Order Details] od
    ON o.OrderID = od.OrderID
GROUP BY c.CompanyName
ORDER BY TotalOrders DESC;


--2. MOSTRA LA CANTIDAD DE " ORDERS" AGRUPADOS POR EL NOMBRE DEL EMPLEADOS
--EJEMPLO: 
--NANCY 20
--JANET 88

SELECT e.FirstName, COUNT(o.OrderID) AS CantidadOrders
FROM Employees e
INNER JOIN Orders o ON e.EmployeeID = o.EmployeeID
GROUP BY e.FirstName;
